#!/bin/bash

echo '🧪 Testing deployment workflow...'

echo '📦 Step 1: Checking executable permissions'
if [[ -x ./DEPLOY && -x ./BANG && -x ./BUILD ]]; then
  echo '✅ All scripts are executable'
else 
  echo '❌ Some scripts are not executable'
  exit 1
fi

echo '📋 Step 2: Checking for required files'
REQUIRED_FILES=('main.py' 'requirements.txt' 'rust_modules/price_calculator/Cargo.toml' 'app/core/config.py')
for file in "${REQUIRED_FILES[@]}"; do
  if [[ -f $file ]]; then
    echo "✅ Found: $file"
  else
    echo "❌ Missing: $file"
    exit 1
  fi
done

echo '🐍 Step 3: Checking Python version'
if command -v python3 &> /dev/null; then
  PYTHON_VERSION=$(python3 --version | cut -d" " -f2 | cut -d"." -f1,2)
  echo "✅ Python version: $PYTHON_VERSION"
else
  echo '❌ Python3 not found'
  exit 1
fi

echo '🎉 All checks passed! Ready for deployment.'
echo ''
echo '📖 Next steps:'
echo '   1. Run ./DEPLOY to set up the environment'
echo '   2. Edit .env file with your configuration'
echo '   3. Run ./BANG to start the application'

